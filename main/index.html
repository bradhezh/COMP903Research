<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TF.js Model Test</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
  </head>
  <body>
    <div id="root"></div>
    <!-- mjs by default; note that `"type": "module"` in package.json is for
      Node -->
    <script type="module" src="/src/main.tsx"></script>
    <script>
    async function testModel() {
      const model = await tf.loadGraphModel('/model/tfjs/model.json')
      console.log('Model loaded!')

      const sample = await fetch(`/data/sample-0.json`).then(r => r.json())
      const label = sample.label
      const pixels = sample.pixels

      const input = tf.tensor(pixels).reshape([1, 28, 28, 1])
      const output = model.predict(input)
      const prediction = await output.argMax(-1).data()
      console.log(`Prediction: ${prediction[0]}, Actual: ${label}`)
      console.log(prediction[0] === label ? 'Correct' : 'Incorrect')

      output.print()
    }

    testModel()
  </script>
  </body>
</html>
